---
title: Korelacja i przyczynowość. Eksperymenty i badania korelacyjne w psychologii a możliwość wnioskowania przyczynowego. Jak w badaniach możemy kontrolować zmienne?
---

# Korelacja nie implikuje przyczynowości

## 

![Hm...](img/w02_spurious/chart-1.png)

<small>Wykres pochodzi z [http://tylervigen.com/spurious-correlations](http://tylervigen.com/spurious-correlations),  
[creative commons license](https://creativecommons.org/licenses/by/4.0/)</small>

##

![Hm...](img/w02_spurious/chart-2.png)

<small>Wykres pochodzi z [http://tylervigen.com/spurious-correlations](http://tylervigen.com/spurious-correlations),  
[creative commons license](https://creativecommons.org/licenses/by/4.0/)</small>

##

![Hm...](img/w02_spurious/chart-3.png)

<small>Wykres pochodzi z [http://tylervigen.com/spurious-correlations](http://tylervigen.com/spurious-correlations),  
[creative commons license](https://creativecommons.org/licenses/by/4.0/)</small>

##

![Hm...](img/w02_spurious/chart-4.png)

<small>Wykres pochodzi z [http://tylervigen.com/spurious-correlations](http://tylervigen.com/spurious-correlations),  
[creative commons license](https://creativecommons.org/licenses/by/4.0/)</small>

##

![Hm...](img/w02_spurious/chart-5.png)

<small>Wykres pochodzi z [http://tylervigen.com/spurious-correlations](http://tylervigen.com/spurious-correlations),  
[creative commons license](https://creativecommons.org/licenses/by/4.0/)</small>

##

![Hm...](img/w02_spurious/chart-6.png)

<small>Wykres pochodzi z [http://tylervigen.com/spurious-correlations](http://tylervigen.com/spurious-correlations),  
[creative commons license](https://creativecommons.org/licenses/by/4.0/)</small>

##

![Hm...](img/w02_spurious/chart-7.png)

<small>Wykres pochodzi z [http://tylervigen.com/spurious-correlations](http://tylervigen.com/spurious-correlations),  
[creative commons license](https://creativecommons.org/licenses/by/4.0/)</small>

## Przywódcy Zwiazku Radzieckiego/Rosji

![](img/w02_russia.png)

# Dlaczego wnioskowanie przyczynowe jest wyzwaniem?

## Przykłady związków między zmiennymi

- długość życia a przynależność do grup o niskim i wysokim statusie socjoekonomicznym (w wybranym okresie, np. w dzieciństwie)
- spodziewana długość życia a dochody (na podstawie analiz demograficznych)

----

- palenie tytoniu przez matkę i niska masa urodzeniowa dziecka

<small>Dla zainteresowanych: związek u ludzi został pokazany z wykorzystaniem [zmiennej instrumentalnej](https://en.wikipedia.org/wiki/Instrumental_variables_estimation) - w tym przypadku była to akcyza na produkty tytoniowe.</small>

----

- płeć a zdolności matematyczne (uwaga: nie ma różnicy między dziewczynkami a chłopcami w ogólnym poziomie zdolności matematycznych)

----

- jedzenie cukierków w dzieciństwie i ryzyko bycia aresztowanym za brutalne przestępstwo w dorosłości

## Czekolada i nagroda Nobla

- Wyniki badania opublikowanego w NEJM [link](https://www.nejm.org/doi/full/10.1056/NEJMon1211064) wskazują, że między konsumpcją czekolady (kg/rok/mieszkaniec) a liczbą nagród Nobla jakie zdobyli obywatele danego państwa istnieje silna, dodatnia, istotna statystycznie korelacja (r = 0,791; p < 0,0001)

## Korelacja to to co widzimy :) przyczynowość = interpretacja

- Należy pamiętać, że kiedy interpretujemy jakąś obaserwację przyczynowo zakładamy, że manipulacja zmienną niezależną spowoduje określone zmiany zmiennej zależnej 

# Statystyczny związek między zmiennymi

## Zmienne a przyczynowość

- Zmienna niezależna **wyjaśnia zmienność** zmiennej zależnej.
- Czasem zmienna niezależna **wpływa na** zmienną zależną, ale nie zawsze.

## Podstawowe rodzaje zależności statystycznych

- Różnice pomiędzy grupami
- Korelacje

# Porównywanie grup

## Jak porównujemy grupy

- Miary tendencji centralnej: średnia, mediana, moda
- Miary zmienności, rozproszenia wyników wokół średniej: odchylenie standardowe, wariancja

## Czy mężczyźni są wyżsi niż kobiety?

## Rozkład wzrostu w próbie

![](figure/w06-height1-1.png){#id .class height=400px}

## Rozkład wzrostu w zależności od płci

![](figure/w06-height2-1.png){#id .class height=400px}

## Czy mężczyźni są wyżsi niż kobiety?

![](figure/w06-height3-1.png){#id .class height=400px}

## Czy mężczyźni są wyżsi niż kobiety?

![](figure/w06-height4-1.png){#id .class height=400px}

## Wykres ramka-wąsy (Tukey)

- *Box-and-whiskers plot*
- W środku mediana
- Ramka od Q1 do Q3
- Wąsy od min do max **bez obserwacji odstających**

## Czy mężczyźni są ciężsi niż kobiety?

![](figure/w06-weight1-1.png){#id .class height=400px}

# Korelacje

## Korelacja

- Siła związku między zmiennymi
- Im silniejszy związek, tym dwie zmienne są bliżej zależności **liniowej**
- Związek najczęściej wyrażony współczynnikiem korelacji

## Współczynnik korelacji

- Technicznie kilka różnych, w praktyce podobna interpretacja
- r Pearsona, rho Spearmana, tau Kendalla
- Wartości od -1 do 1, im wyższa wartość bezwzględna, tym silniejszy związek
- Wsp. korelacji = 1 lub -1 - idealna zależność liniowa

## Korelacje dodatnie i ujemne

- Dodatni/pozytywny związek, r > 0: wyższe wartości A wiążą się z wyższymi B
- Ujemny/negatywny związek, r < 0: wyższe wartości A wiążą się z niższymi B

## Waga jest związana ze wzostem? (N=100)

![](figure/w06-cor1-1.png){#id .class height=400px}

## Waga jest związana ze wzostem? (N=100)

![](figure/w06-cor2-1.png){#id .class height=400px}

## Waga a wzrost (N=10000)

![](figure/w06-cor3-1.png){#id .class height=400px}

## Waga a wzrost (N=10000)

![](figure/w06-cor4-1.png){#id .class height=400px}

## Waga, wzrost a płeć?

![](figure/w06-cor5-1.png){#id .class height=400px}

## Brak związku między zmiennymi (\|r\| < 0,1)

![](figure/w06-cor6-1.png){#id .class height=400px}

## Jaki to związek?

![](figure/w06-cor7-1.png){#id .class height=400px}

## Słaby, dodatni związek (0,1 < \|r\| < 0,3)

![](figure/w06-cor8-1.png){#id .class height=400px}

## Jaki to związek?

![](figure/w06-cor9-1.png){#id .class height=400px}

## Silny, ujemny związek (\|r\| > 0,5)

![](figure/w06-cor10-1.png){#id .class height=400px}

## Jaki to związek?

![](figure/w06-cor11-1.png){#id .class height=400px}

## Umiarkowany, ujemny związek (0,3 < \|r\| < 0,5)

![](figure/w06-cor12-1.png){#id .class height=400px}

## Korelacje dodatnie i ujemne - symulacja

[https://rpsychologist.com/correlation/](https://rpsychologist.com/correlation/)

## Czy z tą korelacją to zawsze taka prosta sprawa?

- Kwatet Anscombe'a
- Zagadka: r = ?

## Pierwszy obrazek z kwartetu

![](figure/w06-anscombe1-1.png){#id .class height=400px}

## Drugi obrazek z kwartetu

![](figure/w06-anscombe2-1.png){#id .class height=400px}

## Trzeci obrazek z kwartetu

![](figure/w06-anscombe3-1.png){#id .class height=400px}

## Czwarty obrazek z kwartetu

![](figure/w06-anscombe4-1.png){#id .class height=400px}

## r = ?

## r = 0.816 dla WSZYSTKICH zbiorów

## Jak to jest możliwe?

- Współczynnik korelacji jest czuły na związki **liniowe**
- Zaburzenie liniowości powoduje "dziwne" efekty
- Czy można powiedzieć że we wszystkich 4 przypadkach związek jest taki sam?

## Inne dziwolągi (zaburzenie liniowości)

![r to zero!](img/w02_0_corr.png){#id .class height=400px}

## Inne dziwolągi (zaburzenie liniowości)

![tu też r zero!](img/w02_0_corr_2.png){#id .class height=400px}

# Wyjaśnianie wariancji

## Równanie jednozmiennowej regresji liniowej

$$y = \beta_0 + \beta_1 * x + \epsilon$$

$x$ - zmienna niezależna, predyktor  
$y$ - zmienna zależna  
$\beta_0, \beta_1$ - współczynniki regesji

## Jeżeli nie mamy żadnej zmiennej wyjaśniającej wariancję (czyli predyktora), naszym najlepszym "strzałem" będzie stwierdzenie, że obserwacja ma wartość średnią.

----------

![](img/exp_var1.jpg){#id .class height=400px}

## Jeżeli mamy predyktor, który mówi, że w grupie A średnia jest o tyle i tyle większa, niż w grupie B, to szacując wartość zmiennej zależnej warto wziąć pod uwagę przynależność do grupy...

## ...bo wtedy pomylimy się mniej, niż biorąc pod uwagę tylko ogólną średnią!

![](img/exp_var2.jpg){#id .class height=400px}

## Różnica powiędzy tym, jak bardzo mylimy się, biorąc pod uwagę tylko ogólną śednią i biorąc pod uwagę predyktor to właśnie wariancja wyjaśniana przez predyktor.

# Związek statystyczny a przyczynowość

## Podstawowe pytanie

- Czy jeśli między a i b występuje związek (korelacja, różnica między grupami) to a **spowodowało** b?
- Być może tak...
- ...albo nie!!!!!!!!!!
- Tylko na podstawie faktu, że a związane jest z b nie możemy wyciągnąć wniosków przyczynowo-skutkowych!

## Jakie są konsekwencje błędnego przyjęcia, że zachodzi związek przyczynowy między zmiennymi?

## Jakie są możliwości? (przykłady z wikipedia.org)

## A powoduje B

- Wiek koreluje ze wzrostem u dzieci
- Dziecko rośnie ponieważ się starzeje, a nie na odwrót

## B powoduje A

- Im szybciej kręcą się wiatraki, tym wiatr wieje szybciej...
- Więc wiatraki powodują wiatr
- ...
- ...mamy dobre argumenty, żeby sądzić, że jest dokładnie na odwrót

## B powoduje A

- Ludzie w średniowieczu wierzyli, że posiadanie wszy jest gwarancją życia w dobrym zdrowiu
- Obserwacja: bardzo rzadko można zaobserwować wszy na chorym człowieku
- ???
- Wszy okazują się być bardzo wrażliwe na temperaturę. Przy najmniejszym stanie podgorączkowym uciekają

## Trzeci czynnik C powoduje A i B

- Spożycie lodów jest silnie dodatnio skorelowane z liczbą zgonów w wyniku utonięcia
- ?
- Wzrost temperatury powoduje wzrost spożycia lodów. Wzrost temperatury powoduje, że więcej ludzi się kąpie i, w konsekwencji, więcej jest utonięć.

## A powoduje B a B powoduje A (zależności cykliczne, sprzężenia zwrotne)

- Rowerzyści mają niższe BMI niż ludzie nie jeżdżący na rowerze
- Czy jazda na rowerze obniża BMI?
- Czy niskie BMI sprzyja jeżdżeniu na rowerze?

## Dodatnie i ujemne sprzężenia zwrotne (_feedback loops_)

- Dodatnie sprzężenie zwrotne:
    - wzrost A powoduje wzrost B
    - wzrost B powoduje wzrost A
    - wzrost A powoduje wzrost B
    - itd.
    - obie zmienne wzrastają

## Dodatnie i ujemne sprzężenia zwrotne (_feedback loops_)

- Ujemne sprzężenie zwrotne:
    - spadek A powoduje spadek B
    - spadek B powoduje spadek A
    - spadek A powoduje spadek B
    - itd.
    - obie zmienne maleją
    
## Sprzężenia zwrotne w psychologii

- Depresja i ból
- Fear avoidance model of chronic pain
- Nieśmiałość i lęk

# Graficzna reprezentacja związku między zmiennymi

## Użyteczne narzędzie

![](img/causal_diagram1.png){#id .class height=400px}

## Nie wiemy o niektórych predyktorach!

![](img/causal_diagram2.png){#id .class height=400px}

## A predyktory też mogą być ze sobą powiązane!

![](img/causal_diagram3.png){#id .class height=400px}

# Przyczynowe sieci Bayesa

## Łańcuch

![](img/mediation.png)

## Schemat rozwidlenia

![](img/rozwidlenie.png)

## Schemat zbiegu

![](img/zbieg.png)

## Paradoks Berksona (Berkson's paradox)

- W momencie, w którym udział w badaniu zależny jest od wystąpienia *przynajmniej jednej* z badanych zmiennych, możemy zaobserwować związek, który nie występuje i np. niesłusznie wyciągnąć wniosek, że wystąpienie jednej choroby chroni przed wystąpieniem drugiej.
- Związek między dwoma zmiennymi obserwujemy ze względu na charakterystykę próby.

## Oryginalny przykład paradoksu Berksona

- Cukrzyca a zapalenie woreczka żółciowego wśród hospitalizowanych pacjentów. Nawet jeżeli nie ma żadnej zależności w ogólnej populacji, może stać się tak, że w badaniu pacjentów, którzy trafiają do szpitala zaobserwujemy, że cukrzyca chroni przez zapaleniem woreczka żółciowego. 
- Osoby które nie mają ani cukrzycy, ani zapalenia woreczka żółciowego mają mniejszą szansę, by trafić do szpitala. 

------

- Ergo, w grupie bez cukrzycy na coś trzeba chorować i może być to zapalenie woreczka żółciowego, pacjentów z zapaleniem woreczka będzie więcej, niż w ogólnej populacji! (Jeżeli szpital leczyłby tylko cukrzycę i zapalenie woreczka, wszyscy mieliby zapalenie woreczka.) A w grupie z cukrzycą tego problemu nie ma - pacjenci trafili do szpitala, bo mają cukrzycę i inny powód nie był potrzebny. W efekcie może okazać się nawet, że cukrzyca chroni przed zapaleniem woreczka żółciowego.

## Inny przykład paradoksu Berksona

- Ujemna korelacja między talentem a urodą oszacowana w oparciu o próbę sławnych osób.
- By zostać sławnym, trzeba albo mieć talent, albo urodę.
- Jeżeli ktoś jest bardzo urodziwy, nie koniecznie musi być utalentowany i na odwrót...
- Zaobserwujemy korelację nawet, jeżeli nie ma jej w ogólnej populacji. 

## Supły

- Jeżeli spróbowalibyśmy odtworzyć sieć powiązań przyczynowych w otaczającym nas świecie, okazałoby się, że wiele zjawisk jest uwarunkowanych poziomem wielu różnych zmiennych i zbiory tych zmiennych są wspólne dla różnych zjawisk.
- Spróbujcie odpowiedzieć sobie na pytanie, czy to stan zdrowia wpływa na powodzenie w życiu, czy odwrotnie! 

-----------

- Niektórzy w związku z występowaniem supłów w obszarze statusu socjoekonomicznego i powiązanych zmiennych mówią nawet o efekcie św. Mateusza: “Każdemu bowiem, kto ma, będzie dodane, tak że nadmiar mieć będzie. Temu zaś, kto nie ma, zabiorą nawet to, co ma” (Mt 25, 29)

# Kiedy możemy mówić o związku przyczynowym?

## Korelacja to to co widzimy :) przyczynowość = interpretacja

- Należy pamiętać, że kiedy interpretujemy jakąś obserwację przyczynowo zakładamy, że manipulacja zmienną niezależną spowoduje określone zmiany zmiennej zależnej.

## Kiedy możemy mówić o związku przyczynowym?

- Kiedy zrobimy dobry **eksperyment**, w którym:
    + kontrolujemy wszystkie zmienne zakłócające i jedynym, co się zmienia, jest poziom zmiennej niezależnej (wykluczalność);
    + losowo przydzielimy osoby do różnych poziomów zmiennej niezależnej (randomizacja).

## Z zachowaniem ***OLBRZYMIEJ*** ostrożności również, gdy:

- Zaobserwujemy związek między zmiennymi (na marginesie: istnieją matematyczne narzędzia, które pozwalają na uprawdopodobnienie założenia o przyczynowości);
- Ustalimy następstwo czasowe (przyczyna musi poprzedzać skutek);
- Będziemy skutecznie kontrolować zmienne zakłócające (uwaga: nigdy nie możemy być pewni, że kontrolujemy wszystkie!);
- Wykluczymy alternatywne wyjaśnienia.

<small>Ustalenie, że te warunki są spełnione wcale nie jest takie proste!</small>

# Podstawowe rodzaje badań w psychologii

## Pytania, które warto sobie zadać

- Czy to my manipulujemy zmienną niezależną, kontrolując jednocześnie poziom innych zmiennych, czy tylko rejestrujemy jej poziom? (wykluczalność!)
- Czy to my kontrolujemy, kto trafi do której grupy (u kogo wystąpi określony poziom zmiennej niezależnej)? (randomizacja!)

## Gdy nie kontrolujemy doboru do grup

- Brak randomizacji
- Nie mamy wpływu na zmienne zakłócające związane z charakterystyką badanych i ich historią.
- W efekcie nie możemy w pełni przypisać obserwowanego efektu zmieniającym się poziomom zmiennej niezależnej.

## Gdy nie manipulujemy sami zmienną niezależną

- Brak wykluczalności
- Nie mamy żadnej gwarancji, że nie zaszły inne równie / bardziej istotne zmiany
- Nie możemy w związku z tym na podstawie naszego badania wnioskować o zależności przyczynowo-skutkowej między zmiennymi

## Rodzaje badań

- Eksperyment
- Quasi-eksperyment
- Eksperyment naturalny
- Badania obserwacyjne

# Eksperymenty

## Jakie warunki powinno spełniać badanie, by było eksperymentem?

- randomizacja + wykluczalność
- Eksperymentem "właściwym" jest np. eksperyment Ascha

## Paradoks Simpsona na przykładzie leczenia kamieni nerkowych

||Leczenie A|Leczenie B|
|:--|:-:|:-:|
| | | |
| | | |
|Ogółem|78% (273/350)|**83% (289/350)**|

<small>Tabela przedstawia liczbę i odsetek tych, u których leczenie zakończyło się sukcesem.</small>

## 

||Leczenie A|Leczenie B|
|:--|:-:|:-:|
|Małe kamienie|**93% (81/87)**|87% (234/270)|
|Duże kamienie|**73% (192/263)**|69% (55/80)|
|Ogółem|78% (273/350)|**83% (289/350)**|

<small>Tabela przedstawia liczbę i odsetek tych, u których leczenie zakończyło się sukcesem. Źródło danych: Charig, C. R., Webb, D. R., Payne, S. R., & Wickham, J. E. (1986). Comparison of treatment of renal calculi by open surgery, percutaneous nephrolithotomy, and extracorporeal shockwave lithotripsy. BMJ, 292(6524), 879–882. https://doi.org/10.1136/bmj.292.6524.879</small>

## Co nie było kontrolowane?

::: incremental

- Dobór badanych do grup
- Paradoks Simpsona pokazuje, jak ważna w eksperymentach jest randomizacja!

:::

# Quasi-eksperymenty

## Manipulujemy zmienną niezależną, nie kontrolujemy doboru do grup

- Quasi-eksperyment, np. badanie Langer i Rodin dotyczące wzbudzania odpowiedzialności
- Znajdujemy w świecie dwie naturalnie występujące grupy, które nie powinny różnic się pod względem badanej zmiennej, w podanym przykładzie osoby mieszkające w domu opieki na dwóch różnych piętrach
- Dokonujemy manipulacji eksperymentalnej i mierzymy jej efekty porównując te grupy

-------

- Niebezpieczeństwo: osoby w obydwu grupach mogły różnić się jeszcze zanim podjęliśmy badania!

# Eksperyment naturalny

## Jak przebiegają eksperymenty naturalne

- Znajdujemy dwie grupy, które różnią się poziomem zmiennej niezależnej.
- Rejestrujemy poziom zmiennej zależnej.

## Przykłady

- Badania bliźniąt :)
- Jeżeli chcemy wykazać, że dana cecha jest przynajmniej w pewnym stopniu zdeterminowana genetycznie, porównujemy to, na ile podobne są do siebie bliźnięta jednojajowe z tym, na ile podobne są do siebie bliźnięta dwujajowe.

# Badania obserwacyjne

## Nie manipulujemy zmienną niezależną, nie kontrolujemy doboru do grup

- porównanie grup, np. ryzyko podejmowane przez kobiety i mężczyzn podczas zmierzania na autobus
- badania korelacyjne, np. związek między różnymi cechami osobowości

# Kontrola zmiennych w badaniach obserwacyjnych

## Korelacja krzyżowa danych panelowych

## Kontrola zmiennej zakłócającej na etapie doboru próby

## Kontrola statystyczna - wielozmiennowe modele regresji